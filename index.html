<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>C++ Lab Typer (Speed Trainer)</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">‚ö°</div>
      <div class="title">
        <div class="name">C++ Lab Typer</div>
        <div class="subtitle">Speed + accuracy training using real OOP labs</div>
      </div>
    </div>

    <div class="top-actions">
      <button id="btnHelp" class="btn ghost">Help</button>
      <a class="btn ghost" href="https://github.com/acs-aburada/oop-2025" target="_blank" rel="noreferrer">Source Repo</a>
    </div>
  </header>

  <main class="container">

    <!-- LOAD FILES -->
    <section class="card">
      <h2>1) Load labs</h2>

      <div class="row">
        <div class="chip" id="chipRepo">Repo: acs-aburada/oop-2025 (branch: main)</div>
        <button id="btnLoadGithub" class="btn primary">Reload from GitHub</button>

        <select id="fileSelect" class="select" disabled>
          <option value="">Loading .cpp files‚Ä¶</option>
        </select>

        <button id="btnRandom" class="btn" disabled>Random</button>
      </div>

      <div class="hint">
        This tool loads <b>.cpp</b> files automatically from the repository. Pick one and start typing.
      </div>

      <div class="hint dim">
        Note: <code>// comments</code> are removed automatically to avoid interference.
      </div>
    </section>

    <!-- PRACTICE SETTINGS -->
    <section class="card" style="margin-top:16px;">
      <h2>2) Practice settings</h2>

      <div class="row">
        <div class="chip">Mode: Countdown practice</div>

        <select id="timerSelect" class="select small">
          <option value="60">1 minute</option>
          <option value="120">2 minutes</option>
          <option value="300" selected>5 minutes</option>
          <option value="600">10 minutes</option>
          <option value="custom">Custom‚Ä¶</option>
        </select>

        <input
          id="customSeconds"
          class="input"
          type="number"
          min="10"
          step="1"
          placeholder="Seconds"
          disabled
        />

        <div class="chip dim">
          Remaining: <span id="remainingTime">--:--</span>
        </div>
      </div>

      <div class="hint dim">
        Tip: When the countdown ends, the run finishes automatically.
      </div>
    </section>

    <!-- SINGLE OVERLAY EDITOR -->
    <section class="card" style="margin-top:16px;">
      <h2>3) Practice (type directly on the code)</h2>

      <div class="toolbar">
        <div class="chip" id="chipFile">No file loaded</div>
        <div class="chip dim" id="chipChars">0 chars</div>
        <div class="chip dim" id="chipLines">0 lines</div>

        <div style="flex:1"></div>

        <button id="btnStart" class="btn primary" disabled>Start</button>
        <button id="btnReset" class="btn" disabled>Reset</button>
        <button id="btnFinish" class="btn danger" disabled>Finish</button>
      </div>

      <div class="editorWrap">
        <pre id="overlay" class="code overlay">(Loading from GitHub‚Ä¶)</pre>

        <textarea
          id="typing"
          class="typingOverlay"
          placeholder="Click Start (or just type) to begin..."
          spellcheck="false"
          autocapitalize="off"
          autocomplete="off"
          autocorrect="off"
          disabled
        ></textarea>
      </div>

      <div class="stats">
        <div class="stat">
          <div class="label">Time</div>
          <div class="value" id="statTime">0.00s</div>
        </div>

        <div class="stat">
          <div class="label">Remaining</div>
          <div class="value" id="statRemain">--:--</div>
        </div>

        <div class="stat">
          <div class="label">WPM (Gross)</div>
          <div class="value" id="statWpmGross">0</div>
        </div>

        <div class="stat">
          <div class="label">WPM (Net)</div>
          <div class="value" id="statWpmNet">0</div>
        </div>

        <div class="stat">
          <div class="label">Accuracy</div>
          <div class="value" id="statAcc">100%</div>
        </div>

        <div class="stat">
          <div class="label">Errors</div>
          <div class="value" id="statErr">0</div>
        </div>

        <div class="stat">
          <div class="label">Error Rate</div>
          <div class="value" id="statErrRate">0%</div>
        </div>

        <div class="stat">
          <div class="label">Progress</div>
          <div class="value" id="statProg">0%</div>
        </div>
      </div>

      <div class="result" id="resultBox" hidden>
        <div class="resultTop">
          <div class="resultTitle">Run finished</div>
          <div class="rank" id="rankBadge">RANK</div>
        </div>

        <div class="resultGrid">
          <div class="mini">
            <div class="miniLabel">Final Time</div>
            <div class="miniValue" id="finalTime">0s</div>
          </div>
          <div class="mini">
            <div class="miniLabel">Gross WPM</div>
            <div class="miniValue" id="finalGross">0</div>
          </div>
          <div class="mini">
            <div class="miniLabel">Net WPM</div>
            <div class="miniValue" id="finalNet">0</div>
          </div>
          <div class="mini">
            <div class="miniLabel">Accuracy</div>
            <div class="miniValue" id="finalAcc">0%</div>
          </div>
          <div class="mini">
            <div class="miniLabel">Errors</div>
            <div class="miniValue" id="finalErr">0</div>
          </div>
          <div class="mini">
            <div class="miniLabel">Error Rate</div>
            <div class="miniValue" id="finalErrRate">0%</div>
          </div>
          <div class="mini">
            <div class="miniLabel">Best Score (This File)</div>
            <div class="miniValue" id="bestScore">‚Äî</div>
          </div>
        </div>

        <div class="resultActions">
          <button id="btnAgain" class="btn primary">Again</button>
          <button id="btnCloseResult" class="btn ghost">Close</button>
        </div>
      </div>
    </section>

    <!-- RANKS -->
    <section class="card" style="margin-top:16px;">
      <h2>üèÜ Ranks</h2>
      <div class="ranks">
        <div class="rankCard">
          <div class="rankName">üêå Turtle</div>
          <div class="rankReq">Net &lt; 25 WPM</div>
        </div>
        <div class="rankCard">
          <div class="rankName">üß™ Junior</div>
          <div class="rankReq">25‚Äì40 WPM</div>
        </div>
        <div class="rankCard">
          <div class="rankName">üíª Dev</div>
          <div class="rankReq">40‚Äì55 WPM</div>
        </div>
        <div class="rankCard">
          <div class="rankName">üî• Fast</div>
          <div class="rankReq">55‚Äì70 WPM</div>
        </div>
        <div class="rankCard">
          <div class="rankName">‚ö° Beast</div>
          <div class="rankReq">70‚Äì85 WPM</div>
        </div>
        <div class="rankCard">
          <div class="rankName">üëë Godlike</div>
          <div class="rankReq">85+ WPM AND 97%+ accuracy</div>
        </div>
      </div>
      <p class="hint dim">
        Net WPM counts only correct characters. Fast + sloppy = lower rank.
      </p>
    </section>

    <!-- HELP MODAL -->
    <div id="helpModal" class="modal" hidden>
      <div class="modalCard">
        <div class="modalHeader">
          <div class="modalTitle">Help</div>
          <button id="btnCloseHelp" type="button" class="btn ghost">X</button>
        </div>

        <div class="modalBody">
          <ol>
            <li>The page auto-loads all <b>.cpp</b> files from <code>acs-aburada/oop-2025</code>.</li>
            <li>Select a file from the dropdown.</li>
            <li>Select your practice duration (presets or custom seconds).</li>
            <li>Click <b>Start</b> or simply begin typing to start the timer.</li>
            <li>Green = correct, red = wrong. Your current character is highlighted.</li>
            <li>The run ends automatically when the countdown hits zero.</li>
          </ol>

          <p class="hint">
            Tip: Pressing <b>TAB</b> inserts 4 spaces automatically.
          </p>

          <p class="hint dim">
            If GitHub blocks requests (rate limit), hit ‚ÄúReload from GitHub‚Äù or try again later.
          </p>
        </div>
      </div>
    </div>

  </main>

  <script src="app.js"></script>
</body>
</html>
